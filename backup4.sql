SET FOREIGN_KEY_CHECKS=0;
SET sql_mode='ANSI_QUOTES';
START TRANSACTION;
CREATE TABLE IF NOT EXISTS "migrations" ("id" integer primary key auto_increment not null, "migration" varchar(255) not null, "batch" integer not null);
INSERT INTO migrations VALUES(1,'0001_01_01_000000_create_users_table',1);
INSERT INTO migrations VALUES(2,'0001_01_01_000001_create_cache_table',1);
INSERT INTO migrations VALUES(3,'0001_01_01_000002_create_jobs_table',1);
INSERT INTO migrations VALUES(4,'2026_01_09_232438_create_habits_table',1);
INSERT INTO migrations VALUES(5,'2026_01_09_232439_create_habit_logs_table',1);
INSERT INTO migrations VALUES(6,'2026_01_09_232441_create_habit_permissions_table',1);
INSERT INTO migrations VALUES(7,'2026_01_12_185602_create_permission_tables',1);
INSERT INTO migrations VALUES(8,'2026_01_12_185715_drop_social_tables',1);
INSERT INTO migrations VALUES(9,'2026_01_12_185716_create_student_guardians_table',1);
INSERT INTO migrations VALUES(10,'2026_01_12_185718_create_classrooms_tables',1);
INSERT INTO migrations VALUES(11,'2026_01_25_074004_update_schema_for_mvp',1);
INSERT INTO migrations VALUES(12,'2026_01_25_075641_refactor_habit_categories_table',1);
INSERT INTO migrations VALUES(13,'2026_01_25_080306_refactor_habit_categories_v2',1);
INSERT INTO migrations VALUES(14,'2026_01_26_082950_add_role_and_genetic_type_to_users_table',1);
INSERT INTO migrations VALUES(15,'2026_01_26_084718_create_student_profiles_table',1);
INSERT INTO migrations VALUES(16,'2026_01_26_085533_create_genetic_types_table',1);
INSERT INTO migrations VALUES(17,'2026_01_26_085533_replace_genetic_type_with_id_in_users_table',1);
INSERT INTO migrations VALUES(18,'2026_01_26_093246_drop_student_id_target_time_sort_order_from_habits_table',1);
INSERT INTO migrations VALUES(19,'2026_01_31_032356_fix_habits_and_categories_structure',1);
INSERT INTO migrations VALUES(20,'2026_01_31_081951_create_habit_user_table',1);
INSERT INTO migrations VALUES(21,'2026_01_31_082310_migrate_existing_habits_to_pivot',1);
CREATE TABLE IF NOT EXISTS "password_reset_tokens" ("email" varchar(255) not null, "token" varchar(255) not null, "created_at" datetime, primary key ("email"));
CREATE TABLE IF NOT EXISTS "sessions" ("id" varchar(255) not null, "user_id" integer, "ip_address" varchar(255), "user_agent" text, "payload" text not null, "last_activity" integer not null, primary key ("id"));
INSERT INTO sessions VALUES('r5X8JimaTFvfZAVWUFEBWxD2CIzzoQrpkmyBmIQq',2,'127.0.0.1','Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36','YTo2OntzOjY6Il90b2tlbiI7czo0MDoidmVKWVE1bllydEhEcGh6eEFUTEdHa0dvQ1UyZzhZZU80bElFMTRSdSI7czozOiJ1cmwiO2E6MTp7czo4OiJpbnRlbmRlZCI7czozMToiaHR0cDovL2xvY2FsaG9zdDo4MDAwL2Rhc2hib2FyZCI7fXM6OToiX3ByZXZpb3VzIjthOjI6e3M6MzoidXJsIjtzOjI4OiJodHRwOi8vbG9jYWxob3N0OjgwMDAvbWVudG9yIjtzOjU6InJvdXRlIjtzOjMxOiJmaWxhbWVudC5tZW50b3IucGFnZXMuZGFzaGJvYXJkIjt9czo2OiJfZmxhc2giO2E6Mjp7czozOiJvbGQiO2E6MDp7fXM6MzoibmV3IjthOjA6e319czo1MDoibG9naW5fd2ViXzU5YmEzNmFkZGMyYjJmOTQwMTU4MGYwMTRjN2Y1OGVhNGUzMDk4OWQiO2k6MjtzOjE3OiJwYXNzd29yZF9oYXNoX3dlYiI7czo2NDoiZjU1YWQ3ZDYzNTg2MzIzMGQyYTRkZmRhYjhiMzMyMWNhYjNkZmFiMmMyOTg5Zjc4MDYyMGJhYzFjYzhmNmE5NCI7fQ==',1769859500);
INSERT INTO sessions VALUES('E3UhcjbN3Y9uSgLt4wHy44hh0W7FokUN57myayxo',1,'127.0.0.1','Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36','YTo1OntzOjY6Il90b2tlbiI7czo0MDoiaG5iTnN6R0M2T2xCdmRLOUNla2F1MERrUmZCYlp1cXQ1Rlg4T1p2cyI7czo5OiJfcHJldmlvdXMiO2E6Mjp7czozOiJ1cmwiO3M6MzU6Imh0dHA6Ly9sb2NhbGhvc3Q6ODAwMC9hZG1pbi9zdHVkZW50IjtzOjU6InJvdXRlIjtzOjM4OiJmaWxhbWVudC5hZG1pbi5yZXNvdXJjZXMuc3R1ZGVudC5pbmRleCI7fXM6NjoiX2ZsYXNoIjthOjI6e3M6Mzoib2xkIjthOjA6e31zOjM6Im5ldyI7YTowOnt9fXM6NTA6ImxvZ2luX3dlYl81OWJhMzZhZGRjMmIyZjk0MDE1ODBmMDE0YzdmNThlYTRlMzA5ODlkIjtpOjE7czoxNzoicGFzc3dvcmRfaGFzaF93ZWIiO3M6NjQ6ImQzODUzODZkYWY3ZGFjMzQ2NmQxYjIyMDAwZjIxNDZkMjdmZTQyZWRkMGQ3ZGQ5ZGI1NDc5M2I1ZjhlNDhmNDMiO30=',1769860322);
INSERT INTO sessions VALUES('YfsrKPKzJCnqk9Kyj7b8modR5ScloSo7WXC9sc30',1,'127.0.0.1','Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15','YTo2OntzOjY6Il90b2tlbiI7czo0MDoiSUthcVJNWmZSN2RvcXRwbHdiSzdISUh1YWFPNFNzTDNPcVNnb0o0NSI7czo2OiJfZmxhc2giO2E6Mjp7czozOiJvbGQiO2E6MDp7fXM6MzoibmV3IjthOjA6e319czozOiJ1cmwiO2E6MTp7czo4OiJpbnRlbmRlZCI7czozMToiaHR0cDovL2xvY2FsaG9zdDo4MDAwL2Rhc2hib2FyZCI7fXM6NTA6ImxvZ2luX3dlYl81OWJhMzZhZGRjMmIyZjk0MDE1ODBmMDE0YzdmNThlYTRlMzA5ODlkIjtpOjE7czoxNzoicGFzc3dvcmRfaGFzaF93ZWIiO3M6NjQ6ImQzODUzODZkYWY3ZGFjMzQ2NmQxYjIyMDAwZjIxNDZkMjdmZTQyZWRkMGQ3ZGQ5ZGI1NDc5M2I1ZjhlNDhmNDMiO3M6OToiX3ByZXZpb3VzIjthOjI6e3M6MzoidXJsIjtzOjM1OiJodHRwOi8vbG9jYWxob3N0OjgwMDAvYWRtaW4vc3R1ZGVudCI7czo1OiJyb3V0ZSI7czozODoiZmlsYW1lbnQuYWRtaW4ucmVzb3VyY2VzLnN0dWRlbnQuaW5kZXgiO319',1769861908);
CREATE TABLE IF NOT EXISTS "cache" ("key" varchar(255) not null, "value" text not null, "expiration" integer not null, primary key ("key"));
INSERT INTO cache VALUES('jurnal-ykde-cache-spatie.permission.cache','a:3:{s:5:"alias";a:0:{}s:11:"permissions";a:0:{}s:5:"roles";a:0:{}}',1769945755);
INSERT INTO cache VALUES('jurnal-ykde-cache-livewire-rate-limiter:a17961fa74e9275d529f489537f179c05d50c2f3:timer','i:1769859538;',1769859538);
INSERT INTO cache VALUES('jurnal-ykde-cache-livewire-rate-limiter:a17961fa74e9275d529f489537f179c05d50c2f3','i:1;',1769859538);
CREATE TABLE IF NOT EXISTS "cache_locks" ("key" varchar(255) not null, "owner" varchar(255) not null, "expiration" integer not null, primary key ("key"));
CREATE TABLE IF NOT EXISTS "jobs" ("id" integer primary key auto_increment not null, "queue" varchar(255) not null, "payload" text not null, "attempts" integer not null, "reserved_at" integer, "available_at" integer not null, "created_at" integer not null);
CREATE TABLE IF NOT EXISTS "job_batches" ("id" varchar(255) not null, "name" varchar(255) not null, "total_jobs" integer not null, "pending_jobs" integer not null, "failed_jobs" integer not null, "failed_job_ids" text not null, "options" text, "cancelled_at" integer, "created_at" integer not null, "finished_at" integer, primary key ("id"));
CREATE TABLE IF NOT EXISTS "failed_jobs" ("id" integer primary key auto_increment not null, "uuid" varchar(255) not null, "connection" text not null, "queue" text not null, "payload" text not null, "exception" text not null, "failed_at" datetime not null default CURRENT_TIMESTAMP);
CREATE TABLE IF NOT EXISTS "permissions" ("id" integer primary key auto_increment not null, "name" varchar(255) not null, "guard_name" varchar(255) not null, "created_at" datetime, "updated_at" datetime);
CREATE TABLE IF NOT EXISTS "roles" ("id" integer primary key auto_increment not null, "name" varchar(255) not null, "guard_name" varchar(255) not null, "created_at" datetime, "updated_at" datetime);
INSERT INTO roles VALUES(1,'admin','web','2026-01-31 11:27:35','2026-01-31 11:27:35');
INSERT INTO roles VALUES(2,'mentor','web','2026-01-31 11:27:35','2026-01-31 11:27:35');
INSERT INTO roles VALUES(3,'student','web','2026-01-31 11:27:35','2026-01-31 11:27:35');
CREATE TABLE IF NOT EXISTS "model_has_permissions" ("permission_id" integer not null, "model_type" varchar(255) not null, "model_id" integer not null, foreign key("permission_id") references "permissions"("id") on delete cascade, primary key ("permission_id", "model_id", "model_type"));
CREATE TABLE IF NOT EXISTS "model_has_roles" ("role_id" integer not null, "model_type" varchar(255) not null, "model_id" integer not null, foreign key("role_id") references "roles"("id") on delete cascade, primary key ("role_id", "model_id", "model_type"));
INSERT INTO model_has_roles VALUES(1,'App\Models\User',1);
INSERT INTO model_has_roles VALUES(2,'App\Models\User',2);
INSERT INTO model_has_roles VALUES(2,'App\Models\User',3);
INSERT INTO model_has_roles VALUES(2,'App\Models\User',4);
INSERT INTO model_has_roles VALUES(2,'App\Models\User',5);
INSERT INTO model_has_roles VALUES(2,'App\Models\User',6);
INSERT INTO model_has_roles VALUES(2,'App\Models\User',7);
INSERT INTO model_has_roles VALUES(2,'App\Models\User',8);
INSERT INTO model_has_roles VALUES(3,'App\Models\User',9);
CREATE TABLE IF NOT EXISTS "role_has_permissions" ("permission_id" integer not null, "role_id" integer not null, foreign key("permission_id") references "permissions"("id") on delete cascade, foreign key("role_id") references "roles"("id") on delete cascade, primary key ("permission_id", "role_id"));
CREATE TABLE IF NOT EXISTS "student_guardians" ("id" integer primary key auto_increment not null, "student_id" integer not null, "guardian_id" integer not null, "created_at" datetime, "updated_at" datetime, foreign key("student_id") references "users"("id") on delete cascade, foreign key("guardian_id") references "users"("id") on delete cascade);
CREATE TABLE IF NOT EXISTS "classrooms" ("id" integer primary key auto_increment not null, "name" varchar(255) not null, "mentor_id" integer not null, "created_at" datetime, "updated_at" datetime, "description" text, "status" varchar(255) not null default 'ACTIVE', foreign key("mentor_id") references "users"("id") on delete cascade);
CREATE TABLE IF NOT EXISTS "classroom_students" ("id" integer primary key auto_increment not null, "classroom_id" integer not null, "student_id" integer not null, "created_at" datetime, "updated_at" datetime, foreign key("classroom_id") references "classrooms"("id") on delete cascade, foreign key("student_id") references "users"("id") on delete cascade);
CREATE TABLE IF NOT EXISTS "class_memberships" ("id" integer primary key auto_increment not null, "class_id" integer not null, "student_id" integer not null, "status" varchar(255) not null default 'ACTIVE', "assigned_by_admin_id" integer, "assigned_at" datetime not null default CURRENT_TIMESTAMP, "ended_at" datetime, "created_at" datetime, "updated_at" datetime, foreign key("class_id") references "classrooms"("id") on delete cascade, foreign key("student_id") references "users"("id") on delete cascade, foreign key("assigned_by_admin_id") references "users"("id") on delete set null);
CREATE TABLE IF NOT EXISTS "daily_reflections" ("id" integer primary key auto_increment not null, "student_id" integer not null, "ref_date" date not null, "mood" varchar(255) not null, "note" text, "created_at" datetime, "updated_at" datetime, foreign key("student_id") references "users"("id") on delete cascade);
CREATE TABLE IF NOT EXISTS "mentor_feedbacks" ("id" integer primary key auto_increment not null, "class_id" integer not null, "mentor_id" integer not null, "student_id" integer not null, "feedback_date" date not null, "message" text not null, "created_at" datetime, "updated_at" datetime, foreign key("class_id") references "classrooms"("id") on delete cascade, foreign key("mentor_id") references "users"("id") on delete cascade, foreign key("student_id") references "users"("id") on delete cascade);
CREATE TABLE IF NOT EXISTS "habit_logs" ("id" integer primary key auto_increment not null, "habit_id" integer not null, "log_date" date not null, "status" varchar(255) not null default ('completed'), "created_at" datetime, "updated_at" datetime, "student_id" integer, "logged_at" datetime, foreign key("habit_id") references habits("id") on delete cascade on update no action, foreign key("student_id") references "users"("id") on delete cascade);
CREATE TABLE IF NOT EXISTS "student_profiles" ("id" integer primary key auto_increment not null, "user_id" integer not null, "birth_date" date, "school_name" varchar(255), "school_address" varchar(255), "grade_level" integer, "school_level" varchar(255), "guardian_name" varchar(255), "guardian_phone" varchar(255), "created_at" datetime, "updated_at" datetime, foreign key("user_id") references "users"("id") on delete cascade);
CREATE TABLE IF NOT EXISTS "genetic_types" ("id" integer primary key auto_increment not null, "name" varchar(255) not null, "description" text, "created_at" datetime, "updated_at" datetime);
CREATE TABLE IF NOT EXISTS "users" ("id" integer primary key auto_increment not null, "name" varchar(255) not null, "username" varchar(255) not null, "email" varchar(255) not null, "email_verified_at" datetime, "password" varchar(255) not null, "remember_token" varchar(255), "created_at" datetime, "updated_at" datetime, "genetic_type_id" integer, foreign key("genetic_type_id") references "genetic_types"("id") on delete set null);
INSERT INTO users VALUES(1,'Admin','admin','admin@admin.com','2026-01-31 11:27:35','$2y$12$itXWMmcsgjcpJL5WSiYcU.k4NP3LlsUED.GtcCKdB5n66trGIswJO',NULL,'2026-01-31 11:27:35','2026-01-31 11:27:35',NULL);
INSERT INTO users VALUES(2,'Mentor User','mentor','mentor@gmail.com','2026-01-31 11:27:36','$2y$12$PaFwS1P2swIFl1Vj6JePeOtp4smGl8A55F7bA8cChkjv8bZMbMNZy','xnRyi4xwKcB9icBDEg7e293NVsGgk6R1hd24YU0VnxFc2E6w6u3CbgXaMplH','2026-01-31 11:27:36','2026-01-31 11:27:36',NULL);
INSERT INTO users VALUES(3,'Mentor 5','mentor5','mentor5@gmail.com','2026-01-31 11:27:36','$2y$12$.lR3DOREo9/O2JB5SjJgo.ELvmM/1L79rVdZmOyHTyeCf4gwtse2a','eqAUL2y26D','2026-01-31 11:27:36','2026-01-31 11:27:36',NULL);
INSERT INTO users VALUES(4,'Lacy Casper','clay79','grosenbaum@example.net','2026-01-31 11:27:36','$2y$12$/dvnp1qSFBZpSMIb.nLUVuSGXcDx5dOqu153nDdF5doGEczZMCMh2','62ajkYkw2U','2026-01-31 11:27:36','2026-01-31 11:27:36',NULL);
INSERT INTO users VALUES(5,'Daisy Donnelly','denesik.reva','aking@example.org','2026-01-31 11:27:36','$2y$12$/dvnp1qSFBZpSMIb.nLUVuSGXcDx5dOqu153nDdF5doGEczZMCMh2','N75bWCrBeW','2026-01-31 11:27:36','2026-01-31 11:27:36',NULL);
INSERT INTO users VALUES(6,'Dr. Davon Bruen DDS','adonnelly','eharvey@example.com','2026-01-31 11:27:36','$2y$12$/dvnp1qSFBZpSMIb.nLUVuSGXcDx5dOqu153nDdF5doGEczZMCMh2','hCQuzYy76p','2026-01-31 11:27:36','2026-01-31 11:27:36',NULL);
INSERT INTO users VALUES(7,'Cindy Pagac','dnolan','sanford.cassidy@example.com','2026-01-31 11:27:36','$2y$12$/dvnp1qSFBZpSMIb.nLUVuSGXcDx5dOqu153nDdF5doGEczZMCMh2','8Od9ujCxt4','2026-01-31 11:27:36','2026-01-31 11:27:36',NULL);
INSERT INTO users VALUES(8,'Leonard Vandervort','tshanahan','leonor.littel@example.net','2026-01-31 11:27:36','$2y$12$/dvnp1qSFBZpSMIb.nLUVuSGXcDx5dOqu153nDdF5doGEczZMCMh2','iZLlDw3JmX','2026-01-31 11:27:36','2026-01-31 11:27:36',NULL);
INSERT INTO users VALUES(9,'Student User','student','student@gmail.com','2026-01-31 11:27:37','$2y$12$/oSx4UZe04hLKRjjue2ih.EzFjsfjJOFVD7JGKYyJARckwOsGgG46','6HbMVX48A2kNfrD6wOVABRO6vQ4v5At1zVwvgS0OAQ7c3TzHtN4xMLYQWtSh','2026-01-31 11:27:37','2026-01-31 11:27:37',NULL);
CREATE TABLE IF NOT EXISTS "habits" ("id" integer primary key auto_increment not null, "title" varchar(255) not null, "description" text, "color" varchar(255) not null default ('#4F46E5'), "frequency" varchar(255) not null default ('daily'), "is_active" tinyint(1) not null default ('0'), "created_at" datetime, "updated_at" datetime, "category_id" integer, "created_by_user_id" integer, "updated_by_user_id" integer, "student_id" integer, foreign key("category_id") references habit_categories("id") on delete set null on update no action, foreign key("created_by_user_id") references users("id") on delete set null on update no action, foreign key("updated_by_user_id") references users("id") on delete set null on update no action, foreign key("student_id") references "users"("id") on delete cascade);
INSERT INTO habits VALUES(1,'Complete Homework','Finish math assignment','#3B82F6','daily',1,'2026-01-31 11:27:37','2026-01-31 11:27:37',NULL,9,NULL,NULL);
CREATE TABLE IF NOT EXISTS "habit_categories" ("id" integer primary key auto_increment not null, "name" varchar(255) not null, "created_by_user_id" integer, "updated_by_user_id" integer, "created_at" datetime, "updated_at" datetime, foreign key("created_by_user_id") references users("id") on delete set null on update no action, foreign key("updated_by_user_id") references users("id") on delete set null on update no action);
INSERT INTO habit_categories VALUES(1,'Bangun',NULL,NULL,'2026-01-31 11:27:35','2026-01-31 11:27:35');
INSERT INTO habit_categories VALUES(2,'Ibadah',NULL,NULL,'2026-01-31 11:27:35','2026-01-31 11:27:35');
INSERT INTO habit_categories VALUES(3,'Olahraga',NULL,NULL,'2026-01-31 11:27:35','2026-01-31 11:27:35');
INSERT INTO habit_categories VALUES(4,'Makan',NULL,NULL,'2026-01-31 11:27:35','2026-01-31 11:27:35');
INSERT INTO habit_categories VALUES(5,'Belajar',NULL,NULL,'2026-01-31 11:27:35','2026-01-31 11:27:35');
INSERT INTO habit_categories VALUES(6,'Bermasyarakat',NULL,NULL,'2026-01-31 11:27:35','2026-01-31 11:27:35');
INSERT INTO habit_categories VALUES(7,'Tidur',NULL,NULL,'2026-01-31 11:27:35','2026-01-31 11:27:35');
CREATE TABLE IF NOT EXISTS "habit_user" ("id" integer primary key auto_increment not null, "habit_id" integer not null, "student_id" integer not null, "color" varchar(255), "frequency" varchar(255) not null default 'daily', "is_active" tinyint(1) not null default '1', "created_at" datetime, "updated_at" datetime, foreign key("habit_id") references "habits"("id") on delete cascade, foreign key("student_id") references "users"("id") on delete cascade);
CREATE INDEX "sessions_user_id_index" on "sessions" ("user_id");
CREATE INDEX "sessions_last_activity_index" on "sessions" ("last_activity");
CREATE INDEX "jobs_queue_index" on "jobs" ("queue");
CREATE UNIQUE INDEX "failed_jobs_uuid_unique" on "failed_jobs" ("uuid");
CREATE UNIQUE INDEX "permissions_name_guard_name_unique" on "permissions" ("name", "guard_name");
CREATE UNIQUE INDEX "roles_name_guard_name_unique" on "roles" ("name", "guard_name");
CREATE INDEX "model_has_permissions_model_id_model_type_index" on "model_has_permissions" ("model_id", "model_type");
CREATE INDEX "model_has_roles_model_id_model_type_index" on "model_has_roles" ("model_id", "model_type");
CREATE UNIQUE INDEX "student_guardians_student_id_guardian_id_unique" on "student_guardians" ("student_id", "guardian_id");
CREATE UNIQUE INDEX "classroom_students_classroom_id_student_id_unique" on "classroom_students" ("classroom_id", "student_id");
CREATE UNIQUE INDEX "class_memberships_class_id_student_id_unique" on "class_memberships" ("class_id", "student_id");
CREATE UNIQUE INDEX "daily_reflections_student_id_ref_date_unique" on "daily_reflections" ("student_id", "ref_date");
CREATE UNIQUE INDEX "habit_logs_habit_id_date_unique" on "habit_logs" ("habit_id", "log_date");
CREATE UNIQUE INDEX "genetic_types_name_unique" on "genetic_types" ("name");
CREATE UNIQUE INDEX "users_email_unique" on "users" ("email");
CREATE UNIQUE INDEX "users_username_unique" on "users" ("username");
CREATE UNIQUE INDEX "habit_user_habit_id_student_id_unique" on "habit_user" ("habit_id", "student_id");
COMMIT;
SET FOREIGN_KEY_CHECKS=1;
